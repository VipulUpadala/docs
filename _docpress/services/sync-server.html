
<div class="doc-layout">
  <div class="toggle menu-toggle js-menu-toggle"></div>
  <ul class="menu toc-menu">
    <li class="menu-item -level-0 -parent">
      <ul class="submenu">
        <li class="menu-item -level-1"><a class="link title  link-index" href="index.html">Tide</a>
        </li>
        <li class="menu-item -level-1 -parent"><a class="link title  link-installation" href="installation/index.html">Installation</a>
          <ul class="submenu">
            <li class="menu-item -level-2"><a class="link title  link-installationprerequisites" href="installation/prerequisites.html">Prerequisites</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-installationcloning" href="installation/cloning.html">Cloning</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-installationsetup" href="installation/setup.html">Setup</a>
            </li>
          </ul>
        </li>
        <li class="menu-item -level-1 -parent"><a class="link title  link-services" href="services/index.html">Services</a>
          <ul class="submenu">
            <li class="menu-item -level-2"><a class="link title  link-servicesapi" href="services/api.html">API</a>
            </li>
            <li class="menu-item -level-2"><a class="link title -active link-servicessync-server" href="services/sync-server.html">Sync Server</a>
              <ul class="headings heading-list">
                <li class="heading-item -depth-2"><a class="hlink link-environment-variables" href="#environment-variables">Environment Variables</a>
                </li>
                <li class="heading-item -depth-2"><a class="hlink link-commands" href="#commands">Commands</a>
                </li>
              </ul>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-servicesphpcs-server" href="services/phpcs-server.html">PHPCS Server</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-serviceslighthouse-server" href="services/lighthouse-server.html">Lighthouse Server</a>
            </li>
          </ul>
        </li>
        <li class="menu-item -level-1 -parent"><a class="link title  link-gcp" href="gcp/index.html">Google Cloud Platform</a>
          <ul class="submenu">
            <li class="menu-item -level-2"><a class="link title  link-gcpgoogle-cloud-storage" href="gcp/google-cloud-storage.html">Google Cloud Storage</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-gcpgoogle-cloud-firestore" href="gcp/google-cloud-firestore.html">Google Cloud Firestore</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-gcpgoogle-cloud-sql" href="gcp/google-cloud-sql.html">Google Cloud SQL</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-gcpgoogle-cloud-memorystore" href="gcp/google-cloud-memorystore.html">Google Cloud Memorystore</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-gcpgoogle-app-engine" href="gcp/google-app-engine.html">Google App Engine</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-gcpgoogle-kubernetes-engine" href="gcp/google-kubernetes-engine.html">Google Kubernetes Engine</a>
            </li>
          </ul>
        </li>
        <li class="menu-item -level-1"><a class="link title  link-aws" href="aws/index.html">Amazon Web Services</a>
        </li>
        <li class="menu-item -level-1 -parent"><span class="title">Important Links</span>
          <ul class="submenu">
            <li class="menu-item -level-2"><a class="link title  link-help" href="help.html">Help</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-local-development" href="local-development.html">Local Development</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-contributing" href="contributing.html">Contributing</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-code-of-conduct" href="code-of-conduct.html">Code of Conduct</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-roadmap" href="roadmap.html">Roadmap</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-sponsors" href="sponsors.html">Sponsors</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-license" href="license.html">License</a>
            </li>
            <li class="menu-item -level-2"><a class="link title  link-search" href="search.html">API Search</a>
            </li>
          </ul>
        </li>
        <li class="menu-item -level-1"><a class="link title  link-404" href="404.html">404</a>
        </li>
      </ul>
    </li>
  </ul>
  <div class="body page-servicessync-server">
    <div class="header-nav">
      <div class="right"><a class="iconlink" href="https://github.com/wptide/docs" data-title="wptide/docs" title="GitHub"><span class="icon -github"></span></a><a class="iconlink" href="https://make.wordpress.org/tide/" data-title="make.wordpress.org/tide" title="WordPress"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><path d="M10 500a490 490 0 1 0 980 0 490 490 0 0 0-980 0zm38 0c0-66 14-128 39-184l216 591A452 452 0 0 1 48 500zm452 452c-44 0-87-6-128-18l136-394 139 380 3 7c-47 16-97 25-150 25zm366-460a427 427 0 0 0 31-209 450 450 0 0 1-170 608l139-399zm-98-140c17 30 37 69 37 125 0 39-11 87-34 146l-45 151-164-486c28-1 52-4 52-4 24-3 22-39-3-38 0 0-73 6-120 6-45 0-119-6-119-6-25-1-28 36-3 38l47 4 71 193-99 297-165-490c27-1 52-4 52-4 24-3 21-39-3-38 0 0-73 6-121 6h-29a452 452 0 0 1 683-85l-5-1c-45 0-76 39-76 80 0 38 21 69 44 106z"/></svg></a></div>
    </div>
    <div class="markdown-body"><h1 id="sync-server">Sync server</h1>
<p>The Sync Server is a Go binary installed on an Alpine Linux Docker image that polls the <a href="http://wp.org">wp.org</a> API&apos;s for themes and plugins to process and writes them to a queue.</p>
<p>Unless you have good reason to set the <code>SYNC_ACTIVE</code> environment variable to <code>on</code> you should leave the server set to <code>off</code> and not bring up the container by running <code>make sync.up</code>. Turning on the Sync Server will put around 50k audits in the queue and will take days to process locally and potentially lock up all your computers resources. A better way to audit <a href="http://wp.org">wp.org</a> themes and plugins would be to follow the instructions found in the <a href="/installation/setup#run-audits">Run Audits</a> section of the setup page.</p>
<p>If you do decide that you would like to seed the queue with plugins and themes, or are testing changes you&apos;ve made to the Go binary, you can run <code>make sync.up</code> for a second or two and then in a different shell run <code>make sync.down</code> which should add a few hundred items to the queue.</p>
<h2 id="environment-variables">Environment Variables</h2>
<table>
<thead>
<tr>
<th style="text-align:left">Variable</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>SYNC_ACTIVE</code></td>
<td style="text-align:left">Whether the Sync Server is active or not. Must be one of: <code>on</code>, <code>off</code>. Default is <code>off</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_API_BROWSE_CATEGORY</code></td>
<td style="text-align:left">The API category used to ingest the <a href="http://wp.org">wp.org</a> themes and plugins. Must be one of: <code>popular</code>, <code>featured</code>, <code>updated</code>, <code>new</code>. Default is <code>updated</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_DATA</code></td>
<td style="text-align:left">When the database provider is set to <code>local</code> this will be where the data is stored relative to the <code>/srv/data</code> working directory. Default is <code>./db</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_DATABASE_DOCUMENT_PATH</code></td>
<td style="text-align:left">When the database provider is set to <code>firestore</code> this value is the path to the document in Cloud Firestore. Must be in the form of <code>&lt;collection&gt;/&lt;document&gt;</code>. Default is <code>sync-server/wporg</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_DATABASE_PROVIDER</code></td>
<td style="text-align:left">Tells the Sync Server which database provider to use; either the local file system or Google Cloud Firestore. Must be one of: <code>local</code>, <code>firestore</code>. Default is <code>local</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_DEFAULT_CLIENT</code></td>
<td style="text-align:left">The API client used to make requests by the audit servers; also associated with the key and secret those server use. Default is <code>wporg</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_DEFAULT_VISIBILITY</code></td>
<td style="text-align:left">The audit and report visibility. Must be one of: <code>public</code>, <code>private</code>. Default is <code>public</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_FORCE_AUDITS</code></td>
<td style="text-align:left">Forces audit reports to be generated even if a report exists for the checksum and standard. Must be one of: <code>yes</code>, <code>no</code>. Default is <code>no</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_ITEMS_PER_PAGE</code></td>
<td style="text-align:left">The number of plugins or themes per page in the API request. Default is <code>250</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_LH_ACTIVE</code></td>
<td style="text-align:left">Send messages to the Lighthouse SQS queue. Must be one of: <code>on</code>, <code>off</code>. Default is <code>on</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_MESSAGE_PROVIDER</code></td>
<td style="text-align:left">Queue audit messages using the local MongoDB, Google Cloud Firestore, or AWS SQS. Must be one of: <code>local</code>, <code>firestore</code>, <code>sqs</code>. Default is <code>local</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_PHPCS_ACTIVE</code></td>
<td style="text-align:left">Send messages to the PHPCS SQS queue. Must be one of: <code>on</code>, <code>off</code>. Default is <code>on</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_POOL_DELAY</code></td>
<td style="text-align:left">The wait time in seconds between the <a href="http://wp.org">wp.org</a> theme and plugin ingests. Default is <code>600</code>.</td>
</tr>
<tr>
<td style="text-align:left"><code>SYNC_POOL_WORKERS</code></td>
<td style="text-align:left">The number of workers (concurrent goroutines) the server will create to ingest the <a href="http://wp.org">wp.org</a> API. Default is <code>125</code>.</td>
</tr>
</tbody>
</table>
<h2 id="commands">Commands</h2>
<table>
<thead>
<tr>
<th style="text-align:left">Command</th>
<th style="text-align:left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>make sync.build.bin</code></td>
<td style="text-align:left">Build the Sync Server Go binary.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.clean.bin</code></td>
<td style="text-align:left">Clean the Sync Server Go binary.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.build.image</code></td>
<td style="text-align:left">Build the Sync Server Docker image.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.build.up</code></td>
<td style="text-align:left">Rebuild the Sync Server Docker image &amp; run the container in isolation with docker-compose up.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.up</code></td>
<td style="text-align:left">Run the Sync Server Docker container in isolation with docker-compose up.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.down</code></td>
<td style="text-align:left">Take the isolated Sync Server Docker container down.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.stop</code></td>
<td style="text-align:left">Stop the isolated Sync Server Docker container with docker-compose stop.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.rm</code></td>
<td style="text-align:left">Remove the stopped Sync Server Docker container with docker-compose rm.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.push.image</code></td>
<td style="text-align:left">Push the Sync Server Docker image to GCR.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.clean.image</code></td>
<td style="text-align:left">Clean the Sync Server Docker image from the host machine.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.build.disk</code></td>
<td style="text-align:left">Build the Sync Server GKE persistent disk.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.build.cluster</code></td>
<td style="text-align:left">Build the Sync Server GKE cluster.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.creds</code></td>
<td style="text-align:left">Get the Sync Server GKE cluster credentials.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.tpl</code></td>
<td style="text-align:left">Generate the Sync Server GKE YAML template.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.deploy.cluster</code></td>
<td style="text-align:left">Deploy the Sync Server GKE cluster.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.get.cluster</code></td>
<td style="text-align:left">Get the Sync Server GKE cluster status.</td>
</tr>
<tr>
<td style="text-align:left"><code>make sync.clean.cluster</code></td>
<td style="text-align:left">Clean the Sync Server GKE cluster.</td>
</tr>
</tbody>
</table>

    </div>
    <div class="footer-nav">
      <div class="left"><a href="../services/api.html"><span class="title">API</span></a></div>
      <div class="right"><a href="../services/phpcs-server.html"><span class="label">Next: </span><span class="title">PHPCS Server</span></a></div>
    </div>
  </div>
</div>